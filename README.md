# hibernate-interceptors

## This project handles the following:

1) Declares a **custom Hibernate interceptor** for intercepting entities, suitable for future audit implementation.
* Small demo about a Hibernate Session Interceptor(Not Session Factory) and the uses cases. 

2) Shows how **N+1 problem** can occur and how to fix it with **JOIN FETCH**
* Small use case on a bidirectional **OneToMany-ManyToOne(LAZY)** Relationship and how we should implement a select query.

3) Shows how **equality should be implemented in Entities** also handling Proxy test cases.
  * When Using Autogenerated Ids, hashcode should return a fixed value
  
  * We should use instanceof in the **Equals** method to compare instances and not compare directly classes. **Proxy instances have a different class than entities**
  
  * We should use getters in the **Equals** method and not directly access fields. **Proxy fields are null, getters return the actual value**.
  * We should use **compareTo** in the **Equals** method when dealing with BigDecimal members. Hibernate retrieves BigDecimals with the precision and scale of the underlying DB column. Two BigDecimal values like "14.00" and "14.0000" are not equal.
4) Detect **N+1** problem and **inefficient queries** in tests with query counters and proxy listeners.
 * Using the **net.ttddyy.dsproxy.listener** we can intercept all the queries in tests and actual count the expected SELECT queries, INSERT queries etc.

5) Shows **entities states** and how they **managed in a transaction**.
* Short demo about dirty checking mechanism and managed entities in a transaction.
